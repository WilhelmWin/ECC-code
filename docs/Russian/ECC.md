# üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–∞ ECC

### –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞:
- 21 —Ñ–µ–≤—Ä–∞–ª—è 2014 –≥–æ–¥–∞
### –ê–≤—Ç–æ—Ä—ã:

- Wesley Janssen

### –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- [Curve25519 in 18 tweets](https://www.cs.ru.nl/bachelors-theses/2014/Wesley_Janssen___4037332___Curve25519_in_18_tweets.pdf)
### –ö–∞–∫ –±—ã–ª–∞ –ø–æ–ª—É—á–µ–Ω–∞:
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∞—É—á–Ω—ã–º —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–º –ú–∏–ª–æ—à–æ–º –î—Ä—É—Ç–∞—Ä–æ–≤—Å–∫–∏–º –≤ —Ö–æ–¥–µ –ø–µ—Ä–≤—ã—Ö
  –≤—Å—Ç—Ä–µ—á —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º.

### –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ?

- [–§–∞–π–ª](https://github.com/WilhelmWin/ECC-code/tree/master/2.0/Source/Curve25519)
  –±—ã–ª –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä.

---
## üîç  –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤, –º–∞–∫—Ä–æ—Å—ã –∏ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã —Ñ—É–Ω–∫—Ü–∏–π
–¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏–º–∏ –∫—Ä–∏–≤—ã–º–∏ (ECC), –≤–∫–ª—é—á–∞—è –±–∞–∑–æ–≤—É—é
–∞—Ä–∏—Ñ–º–µ—Ç–∏–∫—É (—Å–ª–æ–∂–µ–Ω–∏–µ, –≤—ã—á–∏—Ç–∞–Ω–∏–µ, —É–º–Ω–æ–∂–µ–Ω–∏–µ), —Å–∫–∞–ª—è—Ä–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ
–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–æ–ª–µ –ì–∞–ª—É–∞ (GF). –≠—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
—è–≤–ª—è—é—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Å
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏—Ö –∫—Ä–∏–≤—ã—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ –æ–±–º–µ–Ω –∫–ª—é—á–∞–º–∏
–î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π.

### ‚ö†Ô∏è –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –û–ø–µ—Ä–∞—Ü–∏–∏ –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏ –≤ –ø–æ–ª–µ –ì–∞–ª—É–∞ (—Å–ª–æ–∂–µ–Ω–∏–µ, –≤—ã—á–∏—Ç–∞–Ω–∏–µ, —É–º–Ω–æ–∂–µ–Ω–∏–µ,
  –∏–Ω–≤–µ—Ä—Å–∏—è).
- –°–∫–∞–ª—è—Ä–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º—ã.
- –£–ø–∞–∫–æ–≤–∫–∞ –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ —Ç–æ—á–µ–∫ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π.
- –£—Å–ª–æ–≤–Ω—ã–π –≤—ã–±–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π.
- –°–∫–∞–ª—è—Ä–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∞–∑–æ–≤–æ–π —Ç–æ—á–∫–∏ –¥–ª—è
  –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞.

### üì¶ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
- –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π,
  –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–π —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö `long long int` (lli) –¥–ª—è –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª –∏ –º–∞—Å—Å–∏–≤—ã
  `unsigned char` –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –±–∞–π—Ç–æ–≤.
- `ECC.h` - –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º –º–∏—Ä–æ–º
- `session.h` - –¥–ª—è –¥–≤—É—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —Ä–∞–∑–¥–µ–ª–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –∫—Ä–∏–≤–æ–π

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:
–≠—Ç–æ—Ç –∫–æ–¥ —è–≤–ª—è–µ—Ç—Å—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∫–∞–∫ –≤ Linux,
—Ç–∞–∫ –∏ –≤ Windows —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏.

### –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
–§—É–Ω–∫—Ü–∏–∏ –≤ —ç—Ç–æ–º –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–º —Ñ–∞–π–ª–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏
—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏—Ö –∫—Ä–∏–≤—ã—Ö, –≤–∫–ª—é—á–∞—è —Å–∫–∞–ª—è—Ä–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫—É
–≤ –ø–æ–ª–µ –ì–∞–ª—É–∞. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–∞–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∫–ª—é—á–∞—é—Ç:
- `add`, `sub`, `mul`, `inv` –¥–ª—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏ –≤ –ø–æ–ª–µ –ì–∞–ª—É–∞.
- `crypto_scalarmult` –¥–ª—è —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–æ—á–∫–∏ `p` –∏ —Å–∫–∞–ª—è—Ä–∞ `n`.
- `crypto_scalarmult_base` –¥–ª—è —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∞–∑–æ–≤–æ–π —Ç–æ—á–∫–∏ –∫—Ä–∏–≤–æ–π.
- `pack` –∏ `unpack` –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É –±–∞–π—Ç–æ–≤—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏ –∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ø–æ–ª—è –ì–∞–ª—É–∞.

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- **`static gf _121665 = {0xDB41, 1}`**:
  - **static** - –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö Curve25519
  - **gf** - –ü–æ–ª–µ –ì–∞—É–ª–∞
  - **_121665** - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
  - **{0xDB41, 1}** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- **`static uch base[32] = {9};`**: –ë–∞–∑–æ–≤–∞—è –æ–±—â–∞—è —Ç–æ—á–∫–∞ –Ω–∞ Curve25519 –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –∏
  —Å–µ—Ä–≤–µ—Ä–∞. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω–∞
---
## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
### 1. –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è:
```c
    unsigned char q[32];
    const unsigned char n[32] = {...}; // —Å–∫–∞–ª—è—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    const unsigned char p[32] = {...}; // —Ç–æ—á–∫–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π
    crypto_scalarmult(q, n, p); // q = n * p
```
### 2. –î–ª—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –±–∞–π—Ç–æ–≤–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –≤ —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª—è –ì–∞–ª—É–∞:
```c
    gf o;
    unpack(o, n); // n ‚Äî —ç—Ç–æ –±–∞–π—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤
```
### 3. –î–ª—è —É–ø–∞–∫–æ–≤–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ–ª—è –ì–∞–ª—É–∞ –≤ –±–∞–π—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤:
```c
    uch o[32];
    pack(o, n); // n ‚Äî —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª—è –ì–∞–ª—É–∞
```
---
# –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π:

### `car(gf o)`
- –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—è –ì–∞–ª—É–∞, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è,
  —á—Ç–æ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ `[0, 2^16-1]`. –û–Ω–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å, –µ—Å–ª–∏
  —ç–ª–µ–º–µ–Ω—Ç –ø—Ä–µ–≤—ã—à–∞–µ—Ç 16 –±–∏—Ç, –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.

1. –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –≤—Å–µ 16 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞ `o`.
2. –î–æ–±–∞–≤–ª—è–µ—Ç 2^16 –∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.
3. –ü–æ—Å–ª–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞, –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Ö –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–∞.

### `add(gf o, gf a, gf b)`
- –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–æ–∂–µ–Ω–∏–µ –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—è –ì–∞–ª—É–∞ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `o`.

1. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ –º–µ–∂–¥—É –º–∞—Å—Å–∏–≤–∞–º–∏ `a` –∏ `b`.
2. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ `o`.

### `sub(gf o, gf a, gf b)`
- –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—ã—á–∏—Ç–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—è –ì–∞–ª—É–∞ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ o.

1. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ –≤—ã—á–∏—Ç–∞–Ω–∏–µ –º–µ–∂–¥—É –º–∞—Å—Å–∏–≤–∞–º–∏ `a` –∏ `b`.
2. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ `o`.

### `mul(gf o, gf a, gf b)`
- –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç —É–º–Ω–æ–∂–µ–Ω–∏–µ –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—è –ì–∞–ª—É–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–ª–∏–Ω–Ω–æ–≥–æ
  —É–º–Ω–æ–∂–µ–Ω–∏—è –∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫—Ä–∏–≤–æ–π.

1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–º–Ω–æ–∂–µ–Ω–∏–µ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ –º–µ–∂–¥—É –º–∞—Å—Å–∏–≤–∞–º–∏ `a` –∏ `b`.

2. –ü–æ—Å–ª–µ —É–º–Ω–æ–∂–µ–Ω–∏—è, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ `c`, –∑–∞—Ç–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫—Ä–∏–≤–æ–π.

3. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

### `inv(gf o, gf i)`
- –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –ø–æ–ª—è –ì–∞–ª—É–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ –∫–≤–∞–¥—Ä–∞—Ç –∏ —É–º–Ω–æ–∂–µ–Ω–∏—è.

1. –í–Ω–∞—á–∞–ª–µ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤—Ö–æ–¥–Ω–æ–π —ç–ª–µ–º–µ–Ω—Ç `i` –≤ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ `c`.
2. –ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `253` –∏—Ç–µ—Ä–∞—Ü–∏–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∫–∞–∂–¥—ã–π —Ä–∞–∑ —ç–ª–µ–º–µ–Ω—Ç –≤–æ–∑–≤–æ–¥–∏—Ç—Å—è –≤ –∫–≤–∞–¥—Ä–∞—Ç,
   –∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç i –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –µ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
3. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º–∞—Å—Å–∏–≤ `c` —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è `i`.

### `sel(gf p, gf q, int b)`
- –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç —É—Å–ª–æ–≤–Ω—ã–π –≤—ã–±–æ—Ä –º–µ–∂–¥—É –¥–≤—É–º—è —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ø–æ–ª—è –ì–∞–ª—É–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ
  –∑–Ω–∞—á–µ–Ω–∏—è `b` (0 –∏–ª–∏ 1). –ï—Å–ª–∏ `b` —Ä–∞–≤–Ω–æ `1`, –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è `p`, –µ—Å–ª–∏ `0 ‚Äî q`.

1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ XOR –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–µ–∂–¥—É –º–∞—Å—Å–∏–≤–∞–º–∏ p –∏ q.

### `mainloop(lli x[32], uch *z)`
- –≠—Ç–æ—Ç —Ü–∏–∫–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∫–∞–ª—è—Ä–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—è –∫–∞–∂–¥—ã–π –±–∏—Ç —Å–∫–∞–ª—è—Ä–∞
  –∏ –≤—ã–ø–æ–ª–Ω—è—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π.

1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∞—Å—Å–∏–≤–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ø–æ–ª—è.
2. –ü—Ä–æ—Ü–µ—Å—Å —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∏—Ç–∞ —Å–∫–∞–ª—è—Ä–∞ –ø—Ä–∏–º–µ–Ω–∏—Ç—å
   –æ–ø–µ—Ä–∞—Ü–∏–∏ —É—Å–ª–æ–≤–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞, —Å–ª–æ–∂–µ–Ω–∏—è, –≤—ã—á–∏—Ç–∞–Ω–∏—è –∏ —É–º–Ω–æ–∂–µ–Ω–∏—è, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π.
### `unpack(gf o, const uch *n)`
- –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –±–∞–π—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤ n –≤ —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª—è –ì–∞–ª—É–∞ `o`, —Ä–∞—Å—à–∏—Ä—è—è –∫–∞–∂–¥—ã–π –±–∞–π—Ç –≤ 16-–±–∏—Ç–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã.

1. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∞–π—Ç–∞ –∏–∑ –º–∞—Å—Å–∏–≤–∞ n —Å–æ–∑–¥–∞–µ—Ç—Å—è 16-–±–∏—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ `o`.

### `pack(uch *o, gf n)`
- –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª—è –ì–∞–ª—É–∞ `n` –æ–±—Ä–∞—Ç–Ω–æ –≤ –±–∞–π—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤ `o`.

1. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫—Ä–∏–≤–æ–π.

2. –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª—è –ì–∞–ª—É–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –¥–≤–∞ –±–∞–π—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ `o`.

### `crypto_scalarmult(uch *q, const uch *n, const uch *p)`
- –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∫–∞–ª—è—Ä–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ —Ç–æ—á–∫–∏ p –Ω–∞ —Å–∫–∞–ª—è—Ä n, –∏—Å–ø–æ–ª—å–∑—É—è –∞–ª–≥–æ—Ä–∏—Ç–º —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π.

1. –ë–∞–π—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤ n –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ `z`.
2. –¢–æ—á–∫–∞ p —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ –ø–æ–ª–µ –ì–∞–ª—É–∞, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è.
3. –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–º–Ω–æ–∂–µ–Ω–∏—è, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è, –∑–∞—Ç–µ–º —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ —Å–∞–º —Å–µ–±—è, –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ `q`.

### –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞

- `q`: –û–±—â–∏–π –∫–ª—é—á
- `n`: –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Ö–æ—Å—Ç–∞
- `p`: –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–∞


### `crypto_scalarmult_base(uch *q, const uch *n)`
- –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∫–∞–ª—è—Ä–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∞–∑–æ–≤–æ–π —Ç–æ—á–∫–∏ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π.
  –ü–æ–ª—É—á–∞–µ—Ç—Å—è `q = n * G`, –≥–¥–µ `G` ‚Äî —ç—Ç–æ –±–∞–∑–æ–≤–∞—è —Ç–æ—á–∫–∞, –∞ `n` ‚Äî —Å–∫–∞–ª—è—Ä. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `q`.

#### –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞

- `q`: –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Ö–æ—Å—Ç–∞
- `n`: –ü—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º —Ö–æ—Å—Ç–∞
---
# ECC.c

## 1. `car` (Carry operation for elliptic curve elements)

```c
sv car(gf o)
{
    int i;
    lli c;
    for (i = 0; i < 16; i++) {
        o[i] += (1 << 16);  // –û–±–µ—Å–ø–µ—á–∏—Ç—å, —á—Ç–æ–±—ã –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
        c = o[i] >> 16;  // –ü–µ—Ä–µ–Ω–æ—Å, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 16 –±–∏—Ç
        o[(i + 1) * (i < 15)] += c - 1 + 37 * (c - 1) * (i == 15);
        // –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
        o[i] -= c << 16;  // –£–¥–µ—Ä–∂–∞—Ç—å —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–∞
    }
}
```
- `for (i = 0; i < 16; i++)`: –≠—Ç–æ—Ç —Ü–∏–∫–ª –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º 16 —ç–ª–µ–º–µ–Ω—Ç–∞–º –º–∞—Å—Å–∏–≤–∞ o,
  –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª—è –ì–∞–ª—É–∞ GF.

- `o[i] += (1 << 16);`: –î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è 65536 (—ç—Ç–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ 2^16),
  —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π.

- `c = o[i] >> 16;`: –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å (carry) –∏–∑ —Å—Ç–∞—Ä—à–∏—Ö —Ä–∞–∑—Ä—è–¥–æ–≤, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –±–æ–ª—å—à–µ 16 –±–∏—Ç.

- `o[(i + 1) * (i < 15)] += c - 1 + 37 * (c - 1) * (i == 15);`: –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ
  –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç (i < 15), —Ç–æ –ø–µ—Ä–µ–Ω–æ—Å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É.

- `o[i] -= c << 16;`: –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç, –∏—Å–∫–ª—é—á–∞—è –ø–µ—Ä–µ–Ω–æ—Å,
  —á—Ç–æ–±—ã –æ–Ω –æ—Å—Ç–∞–≤–∞–ª—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 0..65535.

## 2. `add` (Addition of two GF elements)

```c
sv add(gf o, gf a, gf b)
{
    int i;
    for (i = 0; i < 16; i++)
        o[i] = a[i] + b[i];  // –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ
}
```

- `for (i = 0; i < 16; i++)`: –ü—Ä–æ—Å—Ç–æ–π —Ü–∏–∫–ª –¥–ª—è –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–≥–æ —Å–ª–æ–∂–µ–Ω–∏—è –¥–≤—É—Ö
  —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—è –ì–∞–ª—É–∞ `a` –∏ `b` –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –º–∞—Å—Å–∏–≤ `o`. –ó–¥–µ—Å—å
  –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ `i` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ª–æ–∂–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

## 3. `sub` (Subtraction of two GF elements)
```c
sv sub(gf o, gf a, gf b)
{
    int i;
    for (i = 0; i < 16; i++)
        o[i] = a[i] - b[i];  // –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ –≤—ã—á–∏—Ç–∞–Ω–∏–µ
}
```

- `for (i = 0; i < 16; i++)`: –ü–æ–¥–æ–±–Ω–æ —Å–ª–æ–∂–µ–Ω–∏—é, —Ü–∏–∫–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ
  –≤—ã—á–∏—Ç–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—è –ì–∞–ª—É–∞ `b` –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—è –ì–∞–ª—É–∞ `a` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç
  —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –º–∞—Å—Å–∏–≤ `o`.

## 4. `mul` (Multiplication of two GF elements)
```c
sv mul(gf o, gf a, gf b)
{
    lli i, j, c[31];
    for (i = 0; i < 31; i++)
        c[i] = 0;  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞
    for (i = 0; i < 16; i++)
        for (j = 0; j < 16; j++)
            c[i + j] += a[i] * b[j];  // –£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    for (i = 16; i < 31; i++)
        c[i - 16] += 38 * c[i];  // –ö–æ—Ä—Ä–µ–∫—Ü–∏—è —Å —É—á—ë—Ç–æ–º —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏ –∫—Ä–∏–≤–æ–π
    for (i = 0; i < 16; i++)
        o[i] = c[i];  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –º–∞—Å—Å–∏–≤
    car(o);  // –û–ø–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    car(o);  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
}

```
- `c[31]`: –°–æ–∑–¥–∞–µ—Ç—Å—è –º–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —É–º–Ω–æ–∂–µ–Ω–∏—è
  –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—è –ì–∞–ª—É–∞.

- `for (i = 0; i < 16; i++)` –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–π —Ü–∏–∫–ª `for (j = 0; j < 16; j++)`: –≠—Ç–∏
  –¥–≤–∞ —Ü–∏–∫–ª–∞ –≤—ã–ø–æ–ª–Ω—è—é—Ç –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –º–∞—Å—Å–∏–≤–∞ a –Ω–∞ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ `b`.
  –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É–º–Ω–æ–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ c –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º `i` + `j`.

- `c[i - 16] += 38 * c[i];`: –ü–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª—è
  –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫—Ä–∏–≤–æ–π (—Å —É—á–µ—Ç–æ–º –µ—ë —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫).

- `car(o);`: –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

## 5. `inv` (Inversion of a GF element)
```c
sv inv(gf o, gf i)
{
    gf c;
    int a;
    for (a = 0; a < 16; a++)
        c[a] = i[a];  // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
    for (a = 253; a >= 0; a--) {
        sq(c, c);  // –í–æ–∑–≤–µ–¥–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –∫–≤–∞–¥—Ä–∞—Ç
        if (a != 2 && a != 4)  // –ü—Ä–æ–ø—É—Å–∫ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            mul(c, c, i);  // –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –æ–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
    }
    for (a = 0; a < 16; a++)
        o[a] = c[a];  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
}

```
- `for (a = 253; a >= 0; a--)`: –≠—Ç–æ—Ç —Ü–∏–∫–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –ø–æ–ª–µ
  –ì–∞–ª—É–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ –∫–≤–∞–¥—Ä–∞—Ç –∏ —É–º–Ω–æ–∂–µ–Ω–∏—è (–∞–ª–≥–æ—Ä–∏—Ç–º –≠–¥–≤–∞—Ä–¥—Å–∞).
  –ö–∞–∂–¥—ã–π —à–∞–≥ –≤ —Ü–∏–∫–ª–µ ‚Äî —ç—Ç–æ –ª–∏–±–æ –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ –∫–≤–∞–¥—Ä–∞—Ç, –ª–∏–±–æ —É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç `i`.

- `if (a != 2 && a != 4)`: –ù–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∏—Ç–µ—Ä–∞—Ü–∏—è—Ö –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —É–º–Ω–æ–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

## 6. `sel` (Conditional select between two GF elements)
```c
sv sel(gf p, gf q, int b)
{
    lli t, i, b1 = ~(b - 1); // b1 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–±–∏—Ç–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
    for (i = 0; i < 16; i++) {
        t = b1 & (p[i] ^ q[i]);  // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–±–∏—Ç–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ XOR –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∞—Å–∫–∏
        p[i] ^= t;  // –í—ã–±–æ—Ä p –∏–ª–∏ q –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–ª–∞–≥–∞ b
        q[i] ^= t;
    }
}

```
- `for (i = 0; i < 16; i++)`: –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–±–∏—Ç–æ–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é
  XOR –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ `p` –∏ `q` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–ª–∞–≥–∞ `b`. –≠—Ç–æ—Ç —Ñ–ª–∞–≥ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–æ–π –∏–∑
  –¥–≤—É—Ö –º–∞—Å—Å–∏–≤–æ–≤ (`p`–∏–ª–∏ `q`) –±—É–¥–µ—Ç –≤—ã–±—Ä–∞–Ω.

## 7. `mainloop` (Main loop for scalar multiplication)
```c
sv mainloop(lli x[32], uch *z)
{
    gf a, b, c, d, e, f;
    lli p, i;
    for (i = 0; i < 16; i++) {
        b[i] = x[i];  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è b —Å –≤—Ö–æ–¥–Ω—ã–º —Å–∫–∞–ª—è—Ä–æ–º
        d[i] = a[i] = c[i] = 0;  // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ 0
    }
    a[0] = d[0] = 1;  // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è a –∏ d
    for (i = 254; i >= 0; --i) {
        p = (z[i >> 3] >> (i & 7)) & 1;  // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ i-–≥–æ –±–∏—Ç–∞ –∏–∑ —Å–∫–∞–ª—è—Ä–∞
        sel(a, b, p);  // –£—Å–ª–æ–≤–Ω—ã–π –≤—ã–±–æ—Ä –º–µ–∂–¥—É a –∏ b –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∏—Ç–∞
        sel(c, d, p);  // –¢–æ –∂–µ –¥–ª—è c –∏ d
        add(e, a, c);  // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π
        sub(a, a, c);
        add(c, b, d);
        sub(b, b, d);
        sq(d, e);  // –í–æ–∑–≤–µ–¥–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∫–≤–∞–¥—Ä–∞—Ç
        sq(f, a);
        mul(a, c, a);  // –£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        mul(c, b, e);
        add(e, a, c);
        sub(a, a, c);
        sq(b, a);
        sub(c, d, f);
        mul(a, c, _121665);  // –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É (_121665)
        add(a, a, d);  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        mul(c, c, a);  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π
        mul(a, d, f);
        mul(d, b, x);  // –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ç–æ—á–∫—É —Å–∫–∞–ª—è—Ä–∞
        sq(b, e);
        sel(a, b, p);  // –§–∏–Ω–∞–ª—å–Ω—ã–π —É—Å–ª–æ–≤–Ω—ã–π –≤—ã–±–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∏—Ç–∞
        sel(c, d, p);
    }
    for (i = 0; i < 16; i++) {
        x[i] = a[i];  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ x
        x[i + 16] = c[i];  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    }
}

```
- `for (i = 254; i >= 0; --i)`: –≠—Ç–æ –≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π
  –±–∏—Ç —Å–∫–∞–ª—è—Ä–∞ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –±–∏—Ç–∞.
  –ö–∞–∂–¥–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Å–ª–æ–∂–µ–Ω–∏–µ, –≤—ã—á–∏—Ç–∞–Ω–∏–µ,
  —É–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ –∫–≤–∞–¥—Ä–∞—Ç, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Ç–∏–ø–∏—á–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ
  –±—ã—Å—Ç—Ä–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–∞ —Å–∫–∞–ª—è—Ä –Ω–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π.

## 8. `crypto_scalarmult` –∏ `crypto_scalarmult_base`

- –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç –æ–ø–µ—Ä–∞—Ü–∏—é —É–º–Ω–æ–∂–µ–Ω–∏—è —Ç–æ—á–∫–∏ –Ω–∞ —Å–∫–∞–ª—è—Ä. crypto_scalarmult
  –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ—á–∫—É p –∏ —Å–∫–∞–ª—è—Ä n, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ crypto_scalarmult_base –∏—Å–ø–æ–ª—å–∑—É–µ—Ç
  –±–∞–∑–æ–≤—É—é —Ç–æ—á–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ—á–∫–∞ –Ω–∞ –∫—Ä–∏–≤–æ–π, –∑–∞—Ä–∞–Ω–µ–µ –≤—ã–±—Ä–∞–Ω–Ω–∞—è).